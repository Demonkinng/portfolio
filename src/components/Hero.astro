---
import Image from "astro/components/Image.astro";
import heroImage from "../assets/stick.png";
import Cv from "../components/icons/Cv.astro";
import SocialPill from "../components/SocialPill.astro";

const roles = [
  "software engineer",
  "full stack developer",
  "design system",
  "cloud enthusiast",
  "crafting code",
];
---

<div class="grid gap-12 lg:grid-cols-2 lg:gap-20 lg:items-center lg:min-h-[70vh]">
  <!-- Left column - Description -->
  <div class="space-y-8 sm:space-y-10">
    <div class="space-y-3">
      <p class="font-mono text-sm uppercase tracking-[0.25em] sm:tracking-[0.35em] text-cyan-500">
        Open to opportunities
      </p>

      <h1 class="text-4xl font-bold tracking-tight sm:text-5xl lg:text-5xl xl:text-6xl text-balance">
        ANGEL CHUNCHO
        <br />
        <!-- Dynamic words -->
        <span
          id="typing-text"
          class="bg-linear-to-l from-cyan-500/50 to-cyan-500 text-transparent bg-clip-text typing-cursor"
          data-roles={JSON.stringify(roles)}>&nbsp;</span
        >
      </h1>
    </div>

    <p class="max-w-lg text-xl sm:text-2xl leading-relaxed text-gray-500">
      Building accessible, performant web applications with modern technologies.
    </p>

    <!-- Call to action -->
    <div class="flex flex-col sm:flex-row gap-4">
      <SocialPill href="#projects" target="_self"> View Projects </SocialPill>
      <SocialPill href="https://drive.google.com/file/d/1WC8rHfKKBx8JTDvrcn39hsuoC4x3EVzL/view?usp=sharing">
        <Cv />
        My CV
      </SocialPill>
    </div>
  </div>

  <!-- Right column - Image Stick -->
  <div class="flex justify-center lg:justify-end">
    <Image
      class="h-auto w-2/3 max-w-65 sm:max-w-sm lg:max-w-md xl:max-w-lg"
      src={heroImage}
      alt="Hero"
      sizes="(min-width:1280px) 480px, (min-width:1024px) 360px, (min-width:640px) 320px, 240px"
    />
  </div>
</div>

<script>
  const el = document.getElementById("typing-text");
  if (el) {
    const roles: string[] = JSON.parse(el.dataset.roles || "[]");
    let currentRole = 0;
    let displayText = "";
    let isDeleting = false;

    function updateText(text: string) {
      el!.textContent = text || "\u00A0";
    }

    function tick() {
      const targetText = roles[currentRole];

      if (!isDeleting) {
        if (displayText.length < targetText.length) {
          displayText = targetText.slice(0, displayText.length + 1);
          updateText(displayText);
          setTimeout(tick, 100);
        } else {
          // Pause before deleting
          setTimeout(() => {
            isDeleting = true;
            tick();
          }, 2000);
        }
      } else {
        if (displayText.length > 0) {
          displayText = displayText.slice(0, -1);
          updateText(displayText);
          setTimeout(tick, 50);
        } else {
          isDeleting = false;
          currentRole = (currentRole + 1) % roles.length;
          setTimeout(tick, 100);
        }
      }
    }

    updateText("");
    tick();
  }
</script>
